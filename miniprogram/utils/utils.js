"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Utils = (function () {
    function Utils() {
    }
    Utils.formatNumber = function (n) {
        var str = n.toString();
        return str[1] ? str : '0' + str;
    };
    Utils.formatTime = function (date) {
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        var hour = date.getHours();
        var minute = date.getMinutes();
        var second = date.getSeconds();
        return [year, month, day].map(this.formatNumber).join('/') + ' ' + [hour, minute, second].map(this.formatNumber).join(':');
    };
    Utils.dateFormat = function (date, fmt) {
        var o = {
            'M+': date.getMonth() + 1,
            'd+': date.getDate(),
            'h+': date.getHours(),
            'm+': date.getMinutes(),
            's+': date.getSeconds(),
            'q+': Math.floor((date.getMonth() + 3) / 3),
            'S': date.getMilliseconds()
        };
        if (/(y+)/.test(fmt))
            fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length));
        for (var k in o) {
            if (new RegExp('(' + k + ')').test(fmt))
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (('00' + o[k]).substr(('' + o[k]).length)));
        }
        return fmt;
    };
    Utils.timeDiff = function (date) {
        var sTime = date.getTime();
        var nowTime = new Date().getTime();
        var d = (nowTime - sTime) / 1000;
        if (d < 60) {
            return Math.floor(d) + " \u79D2\u524D";
        }
        else if (d < 60 * 60) {
            return Math.floor(d / 60) + " \u5206\u949F\u524D";
        }
        else if (d < 60 * 60 * 24) {
            return Math.floor(d / 60 / 60) + " \u5C0F\u65F6\u524D";
        }
        else if (d < 60 * 60 * 24 * 7) {
            return Math.floor(d / 60 / 60 / 24) + " \u5929\u524D";
        }
        else {
            return this.dateFormat(date, 'yyyy-MM-dd hh:mm:ss');
        }
    };
    Utils.childSerialize = function () {
        var children = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            children[_i] = arguments[_i];
        }
        if (!children) {
            return;
        }
        children.map(function (i) {
            i.classView = i.grade.name + " " + i.class.name;
            return i;
        });
    };
    Utils.shareMediaSerialize = function (alpha, share) {
        var s = share.media.height / share.media.width;
        if (share.media.width >= share.media.height) {
            if (share.media.width > 200) {
                share.media.vWidth = 200 * alpha + 'px';
                share.media.vHeight = 200 * s * alpha + 'px';
            }
        }
        else {
            if (share.media.height > 200) {
                share.media.vHeight = 200 * alpha + 'px';
                share.media.vWidth = 200 / s * alpha + 'px';
            }
        }
    };
    Utils.shareSerialize = function (alpha, profile, share) {
        this.shareMediaSerialize(alpha, share);
        share.timeDiff = this.timeDiff(new Date(share.createdAt));
        share.likeUsersView = share.likes.map(function (i) { return i.userName; }).join(',');
        share.liked = share.likes.findIndex(function (j) { return j.id === profile.id; }) > -1;
    };
    Utils.shareListSerialize = function (alpha, profile) {
        var _this = this;
        var shares = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            shares[_i - 2] = arguments[_i];
        }
        if (!shares) {
            return;
        }
        shares.map(function (i) {
            _this.shareSerialize(alpha, profile, i);
            return i;
        });
    };
    Utils.usersNameStr = function (users) {
        if (!users) {
            return '';
        }
        return users.map(function (i) {
            return i.nickName;
        }).join(',');
    };
    return Utils;
}());
exports.Utils = Utils;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ1dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUlBO0lBQUE7SUF1R0EsQ0FBQztJQXRHaUIsa0JBQVksR0FBMUIsVUFBMkIsQ0FBUztRQUNoQyxJQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDekIsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztJQUNwQyxDQUFDO0lBRWEsZ0JBQVUsR0FBeEIsVUFBeUIsSUFBVTtRQUMvQixJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDaEMsSUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNsQyxJQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDM0IsSUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzdCLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNqQyxJQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7UUFFakMsT0FBTyxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMvSCxDQUFDO0lBR2EsZ0JBQVUsR0FBeEIsVUFBeUIsSUFBVSxFQUFFLEdBQVc7UUFDNUMsSUFBTSxDQUFDLEdBQUc7WUFDTixJQUFJLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUM7WUFDekIsSUFBSSxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDcEIsSUFBSSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDckIsSUFBSSxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDdkIsSUFBSSxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDdkIsSUFBSSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzNDLEdBQUcsRUFBRSxJQUFJLENBQUMsZUFBZSxFQUFFO1NBQzlCLENBQUM7UUFDRixJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1lBQUUsR0FBRyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUMzRyxLQUFLLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNiLElBQUksSUFBSSxNQUFNLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO2dCQUFFLEdBQUcsR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQWlCLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBaUIsQ0FBQyxDQUFD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O0lBQ2pCLENBQUM7SUFDTCxZQUFDO0FBQUQsQ0FBQyxBQXZHRCxJQXVHQztBQXZHWSxzQkFBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7U2hhcmV9IGZyb20gJy4vdHlwZXMvc2hhcmUnO1xuaW1wb3J0IHtTdHVkZW50fSBmcm9tICcuL3R5cGVzL3N0dWRlbnQnO1xuaW1wb3J0IHtVc2VyfSBmcm9tICcuL3R5cGVzL3VzZXInO1xuXG5leHBvcnQgY2xhc3MgVXRpbHMge1xuICAgIHB1YmxpYyBzdGF0aWMgZm9ybWF0TnVtYmVyKG46IG51bWJlcikge1xuICAgICAgICBjb25zdCBzdHIgPSBuLnRvU3RyaW5nKCk7XG4gICAgICAgIHJldHVybiBzdHJbMV0gPyBzdHIgOiAnMCcgKyBzdHI7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBmb3JtYXRUaW1lKGRhdGU6IERhdGUpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICBjb25zdCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgICAgIGNvbnN0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgICAgICBjb25zdCBob3VyID0gZGF0ZS5nZXRIb3VycygpO1xuICAgICAgICBjb25zdCBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgY29uc3Qgc2Vjb25kID0gZGF0ZS5nZXRTZWNvbmRzKCk7XG5cbiAgICAgICAgcmV0dXJuIFt5ZWFyLCBtb250aCwgZGF5XS5tYXAodGhpcy5mb3JtYXROdW1iZXIpLmpvaW4oJy8nKSArICcgJyArIFtob3VyLCBtaW51dGUsIHNlY29uZF0ubWFwKHRoaXMuZm9ybWF0TnVtYmVyKS5qb2luKCc6Jyk7XG4gICAgfVxuXG5cbiAgICBwdWJsaWMgc3RhdGljIGRhdGVGb3JtYXQoZGF0ZTogRGF0ZSwgZm10OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBvID0ge1xuICAgICAgICAgICAgJ00rJzogZGF0ZS5nZXRNb250aCgpICsgMSwgLy/mnIjku71cbiAgICAgICAgICAgICdkKyc6IGRhdGUuZ2V0RGF0ZSgpLCAvL+aXpVxuICAgICAgICAgICAgJ2grJzogZGF0ZS5nZXRIb3VycygpLCAvL+Wwj+aXtlxuICAgICAgICAgICAgJ20rJzogZGF0ZS5nZXRNaW51dGVzKCksIC8v5YiGXG4gICAgICAgICAgICAncysnOiBkYXRlLmdldFNlY29uZHMoKSwgLy/np5JcbiAgICAgICAgICAgICdxKyc6IE1hdGguZmxvb3IoKGRhdGUuZ2V0TW9udGgoKSArIDMpIC8gMyksIC8v5a2j5bqmXG4gICAgICAgICAgICAnUyc6IGRhdGUuZ2V0TWlsbGlzZWNvbmRzKCkgLy/mr6vnp5JcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKC8oeSspLy50ZXN0KGZtdCkpIGZtdCA9IGZtdC5yZXBsYWNlKFJlZ0V4cC4kMSwgKGRhdGUuZ2V0RnVsbFllYXIoKSArICcnKS5zdWJzdHIoNCAtIFJlZ0V4cC4kMS5sZW5ndGgpKTtcbiAgICAgICAgZm9yIChsZXQgayBpbiBvKSB7XG4gICAgICAgICAgICBpZiAobmV3IFJlZ0V4cCgnKCcgKyBrICsgJyknKS50ZXN0KGZtdCkpIGZtdCA9IGZtdC5yZXBsYWNlKFJlZ0V4cC4kMSwgKFJlZ0V4cC4kMS5sZW5ndGggPT0gMSkgPyAob1trIGFzIGtleW9mIG9iamVjdF0pIDogKCgnMDAnICsgb1trIGFzIGtleW9mIG9iamVjdF0pLnN1YnN0cigoJycgKyBvW2sgYXMga2V5b2Ygb2JqZWN0XSkubGVuZ3RoKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmbXQ7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyB0aW1lRGlmZihkYXRlOiBEYXRlKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qgc1RpbWUgPSBkYXRlLmdldFRpbWUoKTtcbiAgICAgICAgY29uc3Qgbm93VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICBjb25zdCBkID0gKG5vd1RpbWUgLSBzVGltZSkgLyAxMDAwO1xuICAgICAgICBpZiAoZCA8IDYwKSB7XG4gICAgICAgICAgICByZXR1cm4gYCR7TWF0aC5mbG9vcihkKX0g56eS5YmNYDtcbiAgICAgICAgfSBlbHNlIGlmIChkIDwgNjAgKiA2MCkge1xuICAgICAgICAgICAgcmV0dXJuIGAke01hdGguZmxvb3IoZCAvIDYwKX0g5YiG6ZKf5YmNYDtcbiAgICAgICAgfSBlbHNlIGlmIChkIDwgNjAgKiA2MCAqIDI0KSB7XG4gICAgICAgICAgICByZXR1cm4gYCR7TWF0aC5mbG9vcihkIC8gNjAgLyA2MCl9IOWwj+aXtuWJjWA7XG4gICAgICAgIH0gZWxzZSBpZiAoZCA8IDYwICogNjAgKiAyNCAqIDcpIHtcbiAgICAgICAgICAgIHJldHVybiBgJHtNYXRoLmZsb29yKGQgLyA2MCAvIDYwIC8gMjQpfSDlpKnliY1gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZUZvcm1hdChkYXRlLCAneXl5eS1NTS1kZCBoaDptbTpzcycpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBjaGlsZFNlcmlhbGl6ZSguLi5jaGlsZHJlbjogU3R1ZGVudFtdKSB7XG4gICAgICAgIGlmICghY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjaGlsZHJlbi5tYXAoaSA9PiB7XG4gICAgICAgICAgICBpLmNsYXNzVmlldyA9IGAke2kuZ3JhZGUubmFtZX0gJHtpLmNsYXNzLm5hbWV9YDtcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9KTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgc2hhcmVNZWRpYVNlcmlhbGl6ZShhbHBoYTogbnVtYmVyLCBzaGFyZTogU2hhcmUpIHtcbiAgICAgICAgY29uc3QgcyA9IHNoYXJlLm1lZGlhLmhlaWdodCAvIHNoYXJlLm1lZGlhLndpZHRoO1xuICAgICAgICBpZiAoc2hhcmUubWVkaWEud2lkdGggPj0gc2hhcmUubWVkaWEuaGVpZ2h0KSB7XG4gICAgICAgICAgICBpZiAoc2hhcmUubWVkaWEud2lkdGggPiAyMDApIHtcbiAgICAgICAgICAgICAgICBzaGFyZS5tZWRpYS52V2lkdGggPSAyMDAgKiBhbHBoYSArICdweCc7XG4gICAgICAgICAgICAgICAgc2hhcmUubWVkaWEudkhlaWdodCA9IDIwMCAqIHMgKiBhbHBoYSArICdweCc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoc2hhcmUubWVkaWEuaGVpZ2h0ID4gMjAwKSB7XG4gICAgICAgICAgICAgICAgc2hhcmUubWVkaWEudkhlaWdodCA9IDIwMCAqIGFscGhhICsgJ3B4JztcbiAgICAgICAgICAgICAgICBzaGFyZS5tZWRpYS52V2lkdGggPSAyMDAgLyBzICogYWxwaGEgKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBzaGFyZVNlcmlhbGl6ZShhbHBoYTogbnVtYmVyLCBwcm9maWxlOiBVc2VyLCBzaGFyZTogU2hhcmUpIHtcbiAgICAgICAgdGhpcy5zaGFyZU1lZGlhU2VyaWFsaXplKGFscGhhLCBzaGFyZSk7XG4gICAgICAgIHNoYXJlLnRpbWVEaWZmID0gdGhpcy50aW1lRGlmZihuZXcgRGF0ZShzaGFyZS5jcmVhdGVkQXQpKTtcbiAgICAgICAgc2hhcmUubGlrZVVzZXJzVmlldyA9IHNoYXJlLmxpa2VzLm1hcChpID0+IGkudXNlck5hbWUpLmpvaW4oJywnKTtcbiAgICAgICAgc2hhcmUubGlrZWQgPSBzaGFyZS5saWtlcy5maW5kSW5kZXgoaiA9PiBqLmlkID09PSBwcm9maWxlLmlkKSA+IC0xO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgc2hhcmVMaXN0U2VyaWFsaXplKGFscGhhOiBudW1iZXIsIHByb2ZpbGU6IFVzZXIsIC4uLnNoYXJlczogU2hhcmVbXSkge1xuICAgICAgICBpZiAoIXNoYXJlcykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNoYXJlcy5tYXAoaSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNoYXJlU2VyaWFsaXplKGFscGhhLCBwcm9maWxlLCBpKTtcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHVzZXJzTmFtZVN0cih1c2VyczogVXNlcltdKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCF1c2Vycykge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1c2Vycy5tYXAoaSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaS5uaWNrTmFtZTtcbiAgICAgICAgfSkuam9pbignLCcpO1xuICAgIH1cbn1cbiJdfQ==