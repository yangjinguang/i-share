"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var item_api_1 = require("../../../../apis/item-api");
Page({
    data: {
        itemApi: {},
        tag: {},
        isNew: true
    },
    onLoad: function (query) {
        var _this = this;
        console.log(query['id']);
        var tagId = query['id'];
        this.setData({
            itemApi: new item_api_1.ItemApi()
        });
        if (tagId) {
            this.data.itemApi.getTag(tagId).then(function (result) {
                _this.setData({
                    tag: result,
                    isNew: false
                });
            });
        }
    },
    formSubmit: function (e) {
        console.log(e.detail.value);
        var tag = {
            name: e.detail.value['name']
        };
        if (this.data.isNew) {
            this.data.itemApi.createTag(tag).then(function () {
                wx.navigateBack({
                    delta: 1
                });
            });
        }
        else {
            var id = this.data.tag.id;
            if (id) {
                this.data.itemApi.updateTag(id, tag).then(function () {
                    wx.navigateBack({
                        delta: 1
                    });
                });
            }
        }
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY3JlYXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0RBQWtEO0FBR2xELElBQUksQ0FBQztJQUNELElBQUksRUFBRTtRQUNGLE9BQU8sRUFBVyxFQUFFO1FBQ3BCLEdBQUcsRUFBVyxFQUFFO1FBQ2hCLEtBQUssRUFBRSxJQUFJO0tBQ2Q7SUFDRCxNQUFNLFlBQUMsS0FBVTtRQUFqQixpQkFlQztRQWRHLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDekIsSUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzFCLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDVCxPQUFPLEVBQUUsSUFBSSxrQkFBTyxFQUFFO1NBQ3pCLENBQUMsQ0FBQztRQUNILElBQUksS0FBSyxFQUFFO1lBQ1AsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFBLE1BQU07Z0JBQ3ZDLEtBQUksQ0FBQyxPQUFPLENBQUM7b0JBQ1QsR0FBRyxFQUFFLE1BQU07b0JBQ1gsS0FBSyxFQUFFLEtBQUs7aUJBQ2YsQ0FBQyxDQUFDO1lBQ1AsQ0FBQyxDQUFDLENBQUM7U0FDTjtJQUVMLENBQUM7SUFDRCxVQUFVLFlBQUMsQ0FBTTtRQUNiLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM1QixJQUFNLEdBQUcsR0FBWTtZQUNqQixJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDO1NBQy9CLENBQUM7UUFDRixJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFO1lBQ2pCLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7Z0JBQ2xDLEVBQUUsQ0FBQyxZQUFZLENBQUM7b0JBQ1osS0FBSyxFQUFFLENBQUM7aUJBQ1gsQ0FBQyxDQUFDO1lBQ1AsQ0FBQyxDQUFDLENBQUM7U0FDTjthQUFNO1lBQ0gsSUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQzVCLElBQUksRUFBRSxFQUFFO2dCQUNKLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO29CQUN0QyxFQUFFLENBQUMsWUFBWSxDQUFDO3dCQUNaLEtBQUssRUFBRSxDQUFDO3FCQUNYLENBQUMsQ0FBQztnQkFDUCxDQUFDLENBQUMsQ0FBQzthQUNOO1NBQ0o7SUFDTCxDQUFDO0NBQ0osQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtJdGVtQXBpfSBmcm9tICcuLi8uLi8uLi8uLi9hcGlzL2l0ZW0tYXBpJztcbmltcG9ydCB7SXRlbVRhZ30gZnJvbSAnLi4vLi4vLi4vLi4vdXRpbHMvdHlwZXMvaXRlbS10YWcnO1xuXG5QYWdlKHtcbiAgICBkYXRhOiB7XG4gICAgICAgIGl0ZW1BcGk6IDxJdGVtQXBpPnt9LFxuICAgICAgICB0YWc6IDxJdGVtVGFnPnt9LFxuICAgICAgICBpc05ldzogdHJ1ZVxuICAgIH0sXG4gICAgb25Mb2FkKHF1ZXJ5OiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5sb2cocXVlcnlbJ2lkJ10pO1xuICAgICAgICBjb25zdCB0YWdJZCA9IHF1ZXJ5WydpZCddO1xuICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgICAgaXRlbUFwaTogbmV3IEl0ZW1BcGkoKVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRhZ0lkKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGEuaXRlbUFwaS5nZXRUYWcodGFnSWQpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgICAgICAgICAgICB0YWc6IHJlc3VsdCxcbiAgICAgICAgICAgICAgICAgICAgaXNOZXc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfSxcbiAgICBmb3JtU3VibWl0KGU6IGFueSkge1xuICAgICAgICBjb25zb2xlLmxvZyhlLmRldGFpbC52YWx1ZSk7XG4gICAgICAgIGNvbnN0IHRhZyA9IDxJdGVtVGFnPntcbiAgICAgICAgICAgIG5hbWU6IGUuZGV0YWlsLnZhbHVlWyduYW1lJ11cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZGF0YS5pc05ldykge1xuICAgICAgICAgICAgdGhpcy5kYXRhLml0ZW1BcGkuY3JlYXRlVGFnKHRhZykudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgd3gubmF2aWdhdGVCYWNrKHtcbiAgICAgICAgICAgICAgICAgICAgZGVsdGE6IDFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgaWQgPSB0aGlzLmRhdGEudGFnLmlkO1xuICAgICAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhLml0ZW1BcGkudXBkYXRlVGFnKGlkLCB0YWcpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB3eC5uYXZpZ2F0ZUJhY2soe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGE6IDFcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcbiJdfQ==