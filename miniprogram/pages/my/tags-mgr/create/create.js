"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var item_api_1 = require("../../../../apis/item-api");
Page({
    data: {
        itemApi: {},
        tag: {},
        isNew: true
    },
    onLoad: function (query) {
        var _this = this;
        console.log(query['id']);
        var tagId = query['id'];
        this.setData({
            itemApi: new item_api_1.ItemApi()
        });
        if (tagId) {
            this.data.itemApi.getTag(tagId).then(function (result) {
                _this.setData({
                    tag: result,
                    isNew: false
                });
            });
        }
    },
    formSubmit: function (e) {
        console.log(e.detail.value);
        var tag = {
            name: e.detail.value['name']
        };
        if (this.data.isNew) {
            this.data.itemApi.createTag(tag).then(function () {
                wx.navigateBack({
                    delta: 1
                });
            });
        }
        else {
            var id = this.data.tag.id;
            if (id) {
                this.data.itemApi.updateTag(id, tag).then(function () {
                    wx.navigateBack({
                        delta: 1
                    });
                });
            }
        }
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY3JlYXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0RBQWtEO0FBR2xELElBQUksQ0FBQztJQUNELElBQUksRUFBRTtRQUNGLE9BQU8sRUFBVyxFQUFFO1FBQ3BCLEdBQUcsRUFBVyxFQUFFO1FBQ2hCLEtBQUssRUFBRSxJQUFJO0tBQ2Q7SUFDRCxNQUFNLEVBQU4sVUFBTyxLQUFVO1FBQWpCLGlCQWVDO1FBZEcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN6QixJQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUIsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNULE9BQU8sRUFBRSxJQUFJLGtCQUFPLEVBQUU7U0FDekIsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxLQUFLLEVBQUU7WUFDUCxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUEsTUFBTTtnQkFDdkMsS0FBSSxDQUFDLE9BQU8sQ0FBQztvQkFDVCxHQUFHLEVBQUUsTUFBTTtvQkFDWCxLQUFLLEVBQUUsS0FBSztpQkFDZixDQUFDLENBQUM7WUFDUCxDQUFDLENBQUMsQ0FBQztTQUNOO0lBRUwsQ0FBQztJQUNELFVBQVUsRUFBVixVQUFXLENBQU07UUFDYixPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDNUIsSUFBTSxHQUFHLEdBQVk7WUFDakIsSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQztTQUMvQixDQUFDO1FBQ0YsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNqQixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO2dCQUNsQyxFQUFFLENBQUMsWUFBWSxDQUFDO29CQUNaLEtBQUssRUFBRSxDQUFDO2lCQUNYLENBQUMsQ0FBQztZQUNQLENBQUMsQ0FBQyxDQUFDO1NBQ047YUFBTTtZQUNILElBQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUM1QixJQUFJLEVBQUUsRUFBRTtnQkFDSixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsRUFBRSxFQUFFLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQztvQkFDdEMsRUFBRSxDQUFDLFlBQVksQ0FBQzt3QkFDWixLQUFLLEVBQUUsQ0FBQztxQkFDWCxDQUFDLENBQUM7Z0JBQ1AsQ0FBQyxDQUFDLENBQUM7YUFDTjtTQUNKO0lBQ0wsQ0FBQztDQUNKLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SXRlbUFwaX0gZnJvbSAnLi4vLi4vLi4vLi4vYXBpcy9pdGVtLWFwaSc7XG5pbXBvcnQge0l0ZW1UYWd9IGZyb20gJy4uLy4uLy4uLy4uL3V0aWxzL3R5cGVzL2l0ZW0tdGFnJztcblxuUGFnZSh7XG4gICAgZGF0YToge1xuICAgICAgICBpdGVtQXBpOiA8SXRlbUFwaT57fSxcbiAgICAgICAgdGFnOiA8SXRlbVRhZz57fSxcbiAgICAgICAgaXNOZXc6IHRydWVcbiAgICB9LFxuICAgIG9uTG9hZChxdWVyeTogYW55KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHF1ZXJ5WydpZCddKTtcbiAgICAgICAgY29uc3QgdGFnSWQgPSBxdWVyeVsnaWQnXTtcbiAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgIGl0ZW1BcGk6IG5ldyBJdGVtQXBpKClcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0YWdJZCkge1xuICAgICAgICAgICAgdGhpcy5kYXRhLml0ZW1BcGkuZ2V0VGFnKHRhZ0lkKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgICAgICAgICAgdGFnOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgICAgIGlzTmV3OiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH0sXG4gICAgZm9ybVN1Ym1pdChlOiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5sb2coZS5kZXRhaWwudmFsdWUpO1xuICAgICAgICBjb25zdCB0YWcgPSA8SXRlbVRhZz57XG4gICAgICAgICAgICBuYW1lOiBlLmRldGFpbC52YWx1ZVsnbmFtZSddXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmRhdGEuaXNOZXcpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YS5pdGVtQXBpLmNyZWF0ZVRhZyh0YWcpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHd4Lm5hdmlnYXRlQmFjayh7XG4gICAgICAgICAgICAgICAgICAgIGRlbHRhOiAxXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gdGhpcy5kYXRhLnRhZy5pZDtcbiAgICAgICAgICAgIGlmIChpZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5pdGVtQXBpLnVwZGF0ZVRhZyhpZCwgdGFnKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgd3gubmF2aWdhdGVCYWNrKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhOiAxXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG4iXX0=